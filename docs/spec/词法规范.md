# AetherLang 词法规范

> 本文档定义 AetherLang 的词法规则，包括 Token 类型、关键字、运算符和字面量格式。

> [!NOTE]
> **初版设计**：本规范基于项目书定义，语法风格参考 Rust/Go/Zig，但会根据社区反馈和实际使用体验进行调整。欢迎在 Issues 中提出建议。

## 1. Token 类型

### 1.1 关键字 (Keywords)

| 关键字 | 用途 |
|--------|------|
| `fn` | 函数定义 |
| `let` | 变量绑定 |
| `mut` | 可变性标记 |
| `if` | 条件分支 |
| `else` | 条件分支 |
| `loop` | 无限循环 |
| `while` | 条件循环 |
| `for` | 迭代循环 |
| `in` | 迭代器 |
| `return` | 函数返回 |
| `match` | 模式匹配 |
| `struct` | 结构体定义 |
| `impl` | 方法实现 |
| `enum` | 枚举定义 |
| `interface` | 接口定义 |
| `own` | 所有权转移 |
| `ref` | 不可变借用 |
| `const` | 常量 |
| `unsafe` | 不安全块 |
| `break` | 跳出循环 |
| `continue` | 继续循环 |
| `true` | 布尔真 |
| `false` | 布尔假 |
| `asm` | 内联汇编 |

### 1.2 运算符 (Operators)

#### 算术运算符
| 运算符 | 含义 | 优先级 |
|--------|------|--------|
| `+` | 加法 | 10 |
| `-` | 减法 | 10 |
| `*` | 乘法 | 11 |
| `/` | 除法 | 11 |
| `%` | 取模 | 11 |

#### 比较运算符
| 运算符 | 含义 | 优先级 |
|--------|------|--------|
| `==` | 等于 | 7 |
| `!=` | 不等于 | 7 |
| `<` | 小于 | 8 |
| `<=` | 小于等于 | 8 |
| `>` | 大于 | 8 |
| `>=` | 大于等于 | 8 |

#### 逻辑运算符
| 运算符 | 含义 | 优先级 |
|--------|------|--------|
| `&&` | 逻辑与 | 3 |
| `||` | 逻辑或 | 2 |
| `!` | 逻辑非 | 一元 |

#### 位运算符
| 运算符 | 含义 | 优先级 |
|--------|------|--------|
| `&` | 位与 | 6 |
| `|` | 位或 | 4 |
| `^` | 位异或 | 5 |
| `<<` | 左移 | 9 |
| `>>` | 右移 | 9 |

#### 赋值运算符
| 运算符 | 含义 | 优先级 |
|--------|------|--------|
| `=` | 赋值 | 1 |
| `+=` | 加法赋值 | 1 |
| `-=` | 减法赋值 | 1 |
| `*=` | 乘法赋值 | 1 |
| `/=` | 除法赋值 | 1 |

#### 其他运算符
| 运算符 | 含义 |
|--------|------|
| `->` | 返回类型 |
| `=>` | 匹配分支 |
| `..` | 范围 |
| `::` | 路径分隔 |

### 1.3 分隔符 (Delimiters)

| 符号 | 用途 |
|------|------|
| `(` `)` | 括号 |
| `{` `}` | 代码块 |
| `[` `]` | 数组 |
| `,` | 逗号 |
| `.` | 成员访问 |
| `:` | 类型标注 |
| `;` | 语句结束 |

## 2. 字面量 (Literals)

### 2.1 整数字面量

```
// 十进制
42
1_000_000

// 十六进制
0xFF
0xFFFF_8000_0000_0000

// 二进制 (未来支持)
0b1010
```

### 2.2 浮点字面量

```
3.14
1.0e10
2.5E-3
```

### 2.3 字符串字面量

```
"hello"
"hello\nworld"
"path\\to\\file"
```

转义序列：
| 序列 | 含义 |
|------|------|
| `\n` | 换行 |
| `\r` | 回车 |
| `\t` | 制表符 |
| `\\` | 反斜杠 |
| `\"` | 双引号 |
| `\0` | 空字符 |

### 2.4 字符字面量

```
'a'
'\n'
'\\'
```

### 2.5 布尔字面量

```
true
false
```

## 3. 注释 (Comments)

```
// 单行注释

/* 
 * 多行注释
 * 支持嵌套
 */
```

## 4. 标识符 (Identifiers)

规则：
- 以字母或下划线开头
- 后续可以是字母、数字或下划线
- 区分大小写

```
foo
_bar
camelCase
snake_case
PascalCase
```

## 5. 运算符优先级表 (从低到高)

| 优先级 | 运算符 | 结合性 |
|--------|--------|--------|
| 1 | `=` `+=` `-=` `*=` `/=` | 右 |
| 2 | `||` | 左 |
| 3 | `&&` | 左 |
| 4 | `|` | 左 |
| 5 | `^` | 左 |
| 6 | `&` | 左 |
| 7 | `==` `!=` | 左 |
| 8 | `<` `<=` `>` `>=` | 左 |
| 9 | `<<` `>>` | 左 |
| 10 | `+` `-` | 左 |
| 11 | `*` `/` `%` | 左 |
| 一元 | `-` `!` `*` `&` | 右 |

## 6. 实现参考

- Token 定义: [`src/frontend/token.rs`](file:///c:/Users/Z1529/.gemini/antigravity/scratch/AetherLang/src/frontend/token.rs)
- Lexer 实现: [`src/frontend/lexer.rs`](file:///c:/Users/Z1529/.gemini/antigravity/scratch/AetherLang/src/frontend/lexer.rs)
