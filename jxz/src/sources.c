/* Generated by AetherLang C Backend */
#include <stdint.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <immintrin.h>  /* SSE/AVX */

/* AetherLang Runtime */
static void aether_print(const char* s) { printf("%s", s); }
static void aether_println(const char* s) { printf("%s\n", s); }
static void aether_print_i64(int64_t n) { printf("%lld", (long long)n); }
static void aether_println_i64(int64_t n) { printf("%lld\n", (long long)n); }
static void aether_assert(bool c) { if(!c) { fprintf(stderr, "Assertion failed\n"); exit(1); } }

/* Struct Definitions */
int32_t sources_list(void);
int32_t sources_add(uint8_t*, uint8_t*);
int32_t sources_remove(uint8_t*);
int32_t sources_sync(void);
int32_t sources_reset(void);

int32_t sources_list(void) {
    int32_t _t8;
    int64_t _t1;
    int64_t _t3;
    int64_t _t5;
    int64_t _t7;
    uint8_t* _t0;
    uint8_t* _t2;
    uint8_t* _t4;
    uint8_t* _t6;
    
    _t0 = (uint8_t*)"==> Configured sources:\u{0}";
    puts(_t0);
    _t2 = (uint8_t*)"cat ~/.jxz/sources.list 2>/dev/null || echo \'  (no sources configured, using default)\'\u{0}";
    system(_t2);
    _t4 = (uint8_t*)"\u{0}";
    puts(_t4);
    _t6 = (uint8_t*)"Default: https://registry.aetherlang.org\u{0}";
    puts(_t6);
    _t8 = (int32_t)0LL;
    return _t8;
}

int32_t sources_add(uint8_t* _arg0, uint8_t* _arg1) {
    int32_t _t11;
    int32_t _t12;
    int32_t _t34;
    int32_t _t8;
    int32_t _t9;
    int64_t _t10;
    int64_t _t15;
    int64_t _t17;
    int64_t _t18;
    int64_t _t19;
    int64_t _t23;
    int64_t _t24;
    int64_t _t26;
    int64_t _t27;
    int64_t _t29;
    int64_t _t30;
    int64_t _t33;
    int64_t _t3;
    int64_t _t4;
    int64_t _t6;
    int64_t _t7;
    uint64_t _t13;
    uint64_t _t14;
    uint64_t _t16;
    uint8_t* _t0;
    uint8_t* _t1;
    uint8_t* _t20;
    uint8_t* _t21;
    uint8_t* _t22;
    uint8_t* _t25;
    uint8_t* _t28;
    uint8_t* _t2;
    uint8_t* _t32;
    uint8_t* _t5;
    void* _t31;
    
    _t0 = _arg0;
    _t1 = _arg1;
    _t2 = (uint8_t*)"==> Adding source: \u{0}";
    puts(_t2);
    puts(_t1);
    _t5 = (uint8_t*)"\u{0}";
    puts(_t5);
    strlen(_t1);
    _t8 = (int32_t)_t7;
    _t9 = _t8;
    strlen(_t0);
    _t11 = (int32_t)_t10;
    _t12 = _t11;
    _t13 = (uint64_t)_t9;
    _t14 = (uint64_t)_t12;
    _t15 = _t13 + _t14;
    _t16 = (uint64_t)80LL;
    _t17 = _t15 + _t16;
    _t18 = (int64_t)_t17;
    malloc(_t18);
    _t20 = (uint8_t*)_t19;
    _t21 = _t20;
    _t22 = (uint8_t*)"echo \'\u{0}";
    strcpy(_t21, _t22);
    strcat(_t21, _t1);
    _t25 = (uint8_t*)" \u{0}";
    strcat(_t21, _t25);
    strcat(_t21, _t0);
    _t28 = (uint8_t*)"\' >> ~/.jxz/sources.list\u{0}";
    strcat(_t21, _t28);
    system(_t21);
    _t31 = (void*)_t21;
    free(_t31);
    _t32 = (uint8_t*)"  Source added\u{0}";
    puts(_t32);
    _t34 = (int32_t)0LL;
    return _t34;
}

int32_t sources_remove(uint8_t* _arg0) {
    int32_t _t25;
    int32_t _t7;
    int32_t _t8;
    int64_t _t11;
    int64_t _t12;
    int64_t _t13;
    int64_t _t17;
    int64_t _t18;
    int64_t _t20;
    int64_t _t21;
    int64_t _t24;
    int64_t _t2;
    int64_t _t3;
    int64_t _t5;
    int64_t _t6;
    uint64_t _t10;
    uint64_t _t9;
    uint8_t* _t0;
    uint8_t* _t14;
    uint8_t* _t15;
    uint8_t* _t16;
    uint8_t* _t19;
    uint8_t* _t1;
    uint8_t* _t23;
    uint8_t* _t4;
    void* _t22;
    
    _t0 = _arg0;
    _t1 = (uint8_t*)"==> Removing source: \u{0}";
    puts(_t1);
    puts(_t0);
    _t4 = (uint8_t*)"\u{0}";
    puts(_t4);
    strlen(_t0);
    _t7 = (int32_t)_t6;
    _t8 = _t7;
    _t9 = (uint64_t)_t8;
    _t10 = (uint64_t)100LL;
    _t11 = _t9 + _t10;
    _t12 = (int64_t)_t11;
    malloc(_t12);
    _t14 = (uint8_t*)_t13;
    _t15 = _t14;
    _t16 = (uint8_t*)"grep -v \'^\'\u{0}";
    strcpy(_t15, _t16);
    strcat(_t15, _t0);
    _t19 = (uint8_t*)" \' ~/.jxz/sources.list > /tmp/jxz_src && mv /tmp/jxz_src ~/.jxz/sources.list\u{0}";
    strcat(_t15, _t19);
    system(_t15);
    _t22 = (void*)_t15;
    free(_t22);
    _t23 = (uint8_t*)"  Source removed\u{0}";
    puts(_t23);
    _t25 = (int32_t)0LL;
    return _t25;
}

int32_t sources_sync(void) {
    int32_t _t7;
    int64_t _t10;
    int64_t _t12;
    int64_t _t13;
    int64_t _t15;
    int64_t _t1;
    int64_t _t3;
    int64_t _t5;
    int64_t _t6;
    int64_t _t8;
    uint8_t* _t0;
    uint8_t* _t11;
    uint8_t* _t14;
    uint8_t* _t2;
    uint8_t* _t4;
    uint8_t* _t9;
    
    _t0 = (uint8_t*)"==> Syncing package index from all sources...\u{0}";
    puts(_t0);
    _t2 = (uint8_t*)"  Fetching from registry.aetherlang.org...\u{0}";
    puts(_t2);
    _t4 = (uint8_t*)"curl -sL -o ~/.jxz/db/packages.idx https://registry.aetherlang.org/index.json 2>/dev/null\u{0}";
    system(_t4);
    _t6 = _t5;
    _t7 = (int32_t)0LL;
    _t8 = _t6 == _t7;
    if (_t8) goto L_then; else goto L_else;
L_then:
    _t9 = (uint8_t*)"  \u{2713} Index updated\u{0}";
    puts(_t9);
    goto L_merge;
L_else:
    _t11 = (uint8_t*)"  \u{2717} Failed to fetch index\u{0}";
    puts(_t11);
    goto L_merge;
L_merge:
    _t13 = _t10;
    _t14 = (uint8_t*)"echo \"$(wc -l < ~/.jxz/db/packages.idx 2>/dev/null || echo 0) packages available\"\u{0}";
    system(_t14);
    return _t6;
}

int32_t sources_reset(void) {
    int32_t _t6;
    int64_t _t1;
    int64_t _t3;
    int64_t _t5;
    uint8_t* _t0;
    uint8_t* _t2;
    uint8_t* _t4;
    
    _t0 = (uint8_t*)"==> Resetting sources to default...\u{0}";
    puts(_t0);
    _t2 = (uint8_t*)"rm -f ~/.jxz/sources.list\u{0}";
    system(_t2);
    _t4 = (uint8_t*)"  Sources reset\u{0}";
    puts(_t4);
    _t6 = (int32_t)0LL;
    return _t6;
}

